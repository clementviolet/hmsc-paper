# Results

Both MCMC convergence and effective sample size of the different jSDMs were satisfactory (see Appendix B).

## Model Fit & Predictive power

### Species level

Presence/absence models presented an excellent explanatory power as reflected by mean AUC estimates greater than 0.9 (Fig. S4). Conversely, their predictive power was rather low given a mean AUC estimate of ~0.65 (Fig. S4). For abundance models, mean RMSE computed on the training set ranged from 8.94 to 9.35 (Fig. S4). Their predictive power was heterogeneous with the whole community (WhC) model presenting the highest performance ($\text{mean RMSE} = 5.83$) followed by the benchmark model (Bench) ($\text{mean RMSE} = 53.7$), the phyloheny (Ph) model ($\text{mean RMSE}=63.7$) and the traits & phylogeny model ($\text{mean RMSE} = 95.3$) (Fig. S4).

Relative to the benchmark model (+@fig:fig2), model explanatory power only sightly decreased for both TrPh (mean increase in RMSE +0.8% and decrease in AUC of -0.6%) and Ph models (mean increase in RMSE of +0.5% and decrease in AUC -0.6%). Explanatory power only slightly increased for the WhC models (mean decrease in RMSE of -3.6% and increase in AUC +0.3%). In terms of predictive power, performance mostly increased for the WhC abundance model with a mean decrease in RMSE of 26% relative to the benchmark model. This improvement concerned 62 species (mean decrease in RMSE of -49.3%; 10h and 90th deciles [-94.8% ; -9.7%] for these species) whereas 12 species presented a performance decrease (+36% RMSE; 10th and 90th deciles [10% ; 70.1%]).  Only 32 and 36 species were improved for TrPH and Ph models, with mean decrease/increase in RMSE of 26.5% and 24.9% across all species, respectively.

Model explanatory performance increased for the most common (correlation between RMSE and proportion of presence: Kendall’s τ = -0.28, p-value < 1e-5) and abundant (correlation between RMSE and average species abundance: Kendall’s τ = -0.29, p-value < 1e-4).

![Relative change in explanatory (left column; panels A and C) and predictive (right column; panels B and D) power of different model structures (as colour-coded: purple for benchmark (Bench), yellow for phylogeny (Ph), red for traits & phylogeny (TrPh), and green for whole community (WhC) models). Relative changes (in %)  are expressed relative  to the benchmark fitted on presence/absence (top row; panels A and B) or abundance (bottom row; panels C and D) data. In all panels, points above the zero line (i.e. increase in AUC for panels A-B but decrease in RMSE for panels C-D) indicate performance gain.](figures/fig2.png){#fig:fig2}

### Community level

On the training set, the median Sørensen dissimilarity index, which ranged from 0.36 to 0.38 across all models (both presence/absence and abundance), suggests that predicted communities are relatively similar to observed communities (Fig. S8 and Fig. S9). Errors were equally distributed between turnover and nestedness (Fig. S8 and Fig. S9). However, relative to observed communities in the test data set, abundance models predictions presented a median Sørensen dissimilarity of 0.65 while dissimilarity reached 0.72 for presence/absence models (Fig. S8 and Fig. S9). Greater dissimilarity between predicted and observed communities in the  test dataset relative to the training dataset  is a direct consequence of models’ limited predictive power at the species level (see above and Fig. S8 and Fig. S9). Note that proportion of nestedness errors is greater in the WhC model than in other models, suggesting that this model tends to correctly predict the presence of a subset of the observed species assemblage  composition (Fig. S8 and Fig. S9).

## Variance partitioning

The amount of variance explained by each model can be partitioned between environmental covariates and random effects. For all models, environmental variables account for most (more than 75% ± 18%, mean ± s.d.) of the variance (Fig. S7). However,  a larger part of variance is explained by random effects in the WhC model compared to the Bench model (Fig. S7). Relative to the Bench model, the median relative change in variance explained by random effects increased by 8.6% for the Ph model, 19.9% for the TrPh model and 35.4% for the WhC model (+@fig:fig3). Similar results were obtained for presence/absence models (+@fig:fig3).

![Relative change in variance explained by environmental predictors (left column) and by random effects (right column) according to  alternative  models as colour-coded (purple for Benchmark (Bench), yellow for phylogeny (Ph), red for traits & phylogeny (TrPh), and green for whole community (WhC) models). Percentage change is expressed relative to  the benchmark model fitted with presence/absence (top panels) or abundance (bottom panels) data. In all panels, positive (negative) values point to an increase (decrease) in the proportion of variance explained by the focal model relative to the benchmark model.](figures/fig3.png){#fig:fig3}

## Species niche estimated

For all abundance models, more than 60% of estimated response curves were flat, suggesting a lack of ecologically meaningful species-environment relationships (+@fig:fig4). This proportion even reached more than 80% for the WhC model. Almost no convex or concave responses curves were estimated for abundance models. Meaningful species-environment relationships essentially included constant or accelerated declines, which respectively represented ~10% and ~15% of estimated response curves  for the three models that do not include the whole community (i.e. Bench, TrPh and Ph) (+@fig:fig4). For the WhC model, these percentages dropped to 4.62% and 9.24%, respectively (+@fig:fig4). Similar results were obtained for presence/absence models (Fig. S10).

![Number (y-axis) and proportion (indicated above individual bars) of response curves (i.e. one for each species-predictor combination) according to the nomenclature (nine shapes highlighted by the black curve in each panel) defined by @Rigal_2020 for different abundance model structures. See Fig. S10 for a similar representation for presence-absence models.](figures/fig4.png){#fig:fig4}

Both abundance- and presence/absence TrPh models (which include species functional traits) reveal some meaningful trait-environment relationships between the first fuzzy-PCA axis and the seven environmental predictors. This suggests that the occurrence of certain traits is likely favoured (or hindered) under certain environmental conditions (Fig. S6). For instance, mobile predatory species were more negatively affected by fetch than sessile suspensivores (Fig. S6). Moreover, increase in organic matter concentration and decrease in current velocities were associated with higher abundances of suspensivore populations.

## Exploring the residual correlation

Since all models included the same random effects, residual correlation matrices are comparable. Here, we compared residual correlations between the Bench model and the WhC model both when fitted to presence/absence or abundance data. We specifically considered the WhC model for this specific comparison, because of (1) its higher performances relative to alternative models and (2) the larger proportion of variance explained by random effects in this model relative to others (+@fig:fig3).

Residual correlations estimated by the WhC model were similar to those estimated by the Bench model, regardless of whether the models were fitted on presence/absence or abundance data (+@fig:fig5 and Fig. S11). Yet, agreement between models varied across the different random effects. For instance, when comparing residuals between Bench and WhC fitted on abundance data, correlation was low for random site effects ($\text{R}^2 = 0.66$), moderate for random habitat effects ($\text{R}^2 = 0.8$) and high for random year effects ($\text{R}^2 = 0.91$).

![(A) Comparison of residual correlations associated with the three random effects estimated by the Whole Community Model (y-axis) and the Benchmark model (x-axis) fitted on abundance data. The colour scale highlights the density of points in each scatter plot. (B) Distribution of the index measuring change in sign (sign change left to the zero line, no change to the right) and magnitude (higher departure from the zero line indicate higher difference) between residual correlations estimated by the whole community model and the benchmark model adjusted with abundance data for the three random effects (Habitat, Site, Year).](figures/fig5.png){#fig:fig5}

The dedicated comparison index helps qualify how pairwise species-species residual correlations change in sign and magnitude between the Bench and the WhC models. For abundance- or presence/absence models (+@fig:fig5 and Fig. S11), the index main modal distribution, which is centred on zero, suggests an overall agreement between residual correlations obtained from both models (+@fig:fig5 and Fig. S11). While the right part of the distribution highlights variation in the estimated magnitude of effect, on the left-hand part of the distribution (negative values) indicates a sign inconsistency in residual correlations between the two models. For abundance models, the Habitat, Site and Year random effects  are respectively  associated with 13.3%, 17.7% and 6% of sign inconsistencies in residual correlations between the Bench model and the WhC model. Similar results were obtained for presence/absence models.